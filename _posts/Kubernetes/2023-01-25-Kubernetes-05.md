---
layout:     BLACKCODE
title:      "Kubernetes [6/36]"
subtitle:   "[따배쿠] 3-2. kubectl command / pod 생성하기"
description: "https://www.youtube.com/playlist?list=PLApuRlvrZKohaBHvXAOhUD-RxD0uQ3z0c"
date:       2023-01-25 1:10:00
author:     "MADness"
header-img: "assets/owner/hero/home-bg.jpg"
header-video: "assets/video/metrix.mp4"
thumbnail: /assets/owner/blog/thumbs/thumb01.png
tags: [Azure]
category: [Kubernetes]
# comments: false
# share: false
---

<iframe width="560" height="315" src="https://www.youtube.com/embed/QGF7igBYSEI?list=PLApuRlvrZKohaBHvXAOhUD-RxD0uQ3z0c" title="[따배쿠] 3-2. kubectl command / pod 생성하기" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

---

안녕하세요, 이성미 강사입니다!
어렵게만 느껴지는 쿠버네티스,
따라하면서 배우면 어느새 지식이 되어 있을 겁니다!

오늘은 3-1강에 이어 kubectl command를 알아보고, 직접 pod 생성까지 !
영상의 길이가 조금 길지만 그래도 화이팅 해주시기 바랍니다 !!

이 영상을 보기 전 이전 영상을 꼭 시청해 주세요:)

---

00:00 오늘 배울 내용 소개
00:55 kubectl command 살펴보기
09:28 여러 방법으로 nginx pod 생성하기 / 동작 확인하기

---

# kubernetes 명령어 실습전 사전 준비

## VSCODE에서 Azure Potal 접속
1. VSCODE에서 Azure Cloud Shell 클릭
![img](https://github.com/IIBlackCode/IIBlackCode.github.io/blob/master/_posts/Kubernetes/img/2023-01-25-Kubernetes-05_1.png?raw=true)

2. 상단에 구독 선택
![img](https://github.com/IIBlackCode/IIBlackCode.github.io/blob/master/_posts/Kubernetes/img/2023-01-25-Kubernetes-05_2.png?raw=true)

3. VSCode에서 접속 성공한 모습
![img](https://github.com/IIBlackCode/IIBlackCode.github.io/blob/master/_posts/Kubernetes/img/2023-01-25-Kubernetes-05_3.png?raw=true)

# kubectl 명령어 실습

- 컨테이너 실행
    - run : 컨테이너 POD를 만듦
    - webserver : pod 이름
    - webserver는 80포트에서 listen
    - -가 하나(-) : system field 계열, 축약어
    - -가 두개(--): 옵션을 풀어서 사용
```
kubectl run webserver --image=nginx:1.14 --port 80
```

#### 결과 화면
```
PS /home/minseo_kim89> kubectl run webserver --image=nginx:1.14 --port 80
pod/webserver created
```

- pod 상태 보기
```
kubectl get pods
```

- 생성한 webserver pod상태 보기
```
kubectl describe pod webserver
```

#### 결과 화면
```
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  17m   default-scheduler  Successfully assigned default/webserver to aks-agentpool-33010371-vmss000000
  Normal  Pulling    17m   kubelet            Pulling image "nginx:1.14"
  Normal  Pulled     17m   kubelet            Successfully pulled image "nginx:1.14" in 5.857415651s
  Normal  Created    17m   kubelet            Created container webserver
  Normal  Started    17m   kubelet            Started container webserver
```

- pod 상태 자세히 보기
```
kubectl get pods -o wide
```

#### 결과 화면
```
NAME        READY   STATUS    RESTARTS   AGE   IP            NODE                                NOMINATED NODE   READINESS GATES
webserver   1/1     Running   0          19m   10.244.0.15   aks-agentpool-33010371-vmss000000   <none>           <none>
```

- webserver 접속 - 안나오네?
    - Azure Potal 환경에서 Shell환경과 네트워크가 달라 표시 안됨
```
curl 10.244.0.15
```

- 배포용 pod 생성
    - image=httpd : image를 아파치웹서버로 생성
    - latest : 생략하면 latest버전으로 생성됨
    - --replicas=3 : httpd라는 웹서버 3개 생성, deploy를 사용하는 이유
```
kubectl create deployment mainui --image=httpd --replicas=3
``` 

#### 결과 화면
```
PS /home/minseo_kim89> kubectl create deployment mainui --image=httpd --replicas=3 
deployment.apps/mainui created
```

- 생성한 pod 확인
```
kubectl get deployments.apps
```

#### 결과 화면
```
PS /home/minseo_kim89> kubectl get deployments.apps
NAME     READY   UP-TO-DATE   AVAILABLE   AGE
mainui   3/3     3            3           60s
```

- pod 상세정보 확인
```
kubectl describe deployments.apps mainui
```

```
PS /home/minseo_kim89> kubectl describe deployments.apps mainui
Name:                   mainui
Namespace:              default
CreationTimestamp:      Wed, 25 Jan 2023 09:25:32 +0000
Labels:                 app=mainui
Annotations:            deployment.kubernetes.io/revision: 1
Selector:               app=mainui
Replicas:               3 desired | 3 updated | 3 total | 3 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=mainui
  Containers:
   httpd:
    Image:        httpd
    Port:         <none>
    Host Port:    <none>
    Environment:  <none>
    Mounts:       <none>
  Volumes:        <none>
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  <none>
NewReplicaSet:   mainui-77fc86948f (3/3 replicas created)
Events:
  Type    Reason             Age    From                   Message
  ----    ------             ----   ----                   -------
  Normal  ScalingReplicaSet  3m20s  deployment-controller  Scaled up replica set mainui-77fc86948f to 3
```

- pod 조회
    - 명령어
```
kubectl get pods
kubectl get pods -o wide
```

```
PS /home/minseo_kim89> kubectl get pods
NAME                      READY   STATUS    RESTARTS   AGE
mainui-77fc86948f-2srr9   1/1     Running   0          4m4s
mainui-77fc86948f-b56k7   1/1     Running   0          4m4s
mainui-77fc86948f-swc2c   1/1     Running   0          4m4s
webserver                 1/1     Running   0          43m
```

- pod 하나만 지정해서 보기
```
kubectl get pod mainui-77fc86948f-2srr9
kubectl get pod mainui-77fc86948f-2srr9 -o wide
```
---
25:27